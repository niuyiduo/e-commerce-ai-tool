# 电商商品素材智能生成工具 - 项目演示文档

> ⚠️ **重要提示**：强烈推荐在本地环境运行本项目！
> 
> - 💻 **本地运行**：无超时限制，响应快速稳定，所有功能完整可用
> - ⚠️ **线上部署**：Vercel 免费版有 10 秒限制，AI 分析易超时
> - 💡 **如何本地运行**：`npm install` → `npm run dev` → 访问 `http://localhost:3000`
> 
> 详细步骤请查看 [README.md](./README.md) 的“本地开发”章节。

## 📋 目录

1. [项目概述](#项目概述)
2. [核心功能](#核心功能)
3. [技术架构](#技术架构)
4. [功能演示](#功能演示)
5. [部署与CI/CD](#部署与cicd)
6. [使用指南](#使用指南)
7. [项目亮点](#项目亮点)

---

## 1. 项目概述

### 1.1 项目背景

随着AI技术的发展，电商素材制作需要更便捷的方式。

本项目利用 **AI 技术**，实现商品素材的**智能化、自动化生成**，大幅提升工作效率。

### 1.2 项目定位

**电商商品素材智能生成工具** 是一个基于 Next.js + 火山引擎 AI 的前端应用，为电商从业者提供：
- 🤖 AI 驱动的商品文案生成
- 🖼️ 一键生成带水印的宣传图
- 🎥 多图合成产品讲解视频
- 🔄 完整的 CI/CD 自动化部署

### 1.3 核心价值

**AI驱动的一站式素材生成工具**：
- 🤖 AI 秒级生成商品文案
- 🖼️ AI 智能装饰宣传图
- 🎥 虚拟形象讲解视频
- ⚡ 简单高效，即时可用

---

## 2. 核心功能

### 2.1 功能架构图

```
电商商品素材智能生成工具
├── 📸 图片处理模块
│   ├── 拖拽/点击上传
│   ├── 图片预览
│   └── 多图管理
├── 🤖 AI 生成模块
│   ├── 商品标题生成
│   ├── 商品卖点生成
│   ├── 装饰宣传图生成
│   │   ├── 普通装饰模式（100+ 贴纸）
│   │   └── 高级定制模式（AI 智能分析）
│   ├── 多模型切换（6个豆包模型）
│   │   ├── 4个文本模型
│   │   └── 2个多模态模型（Vision + Thinking）
│   ├── 智能反馈优化机制
│   ├── 边框风格选择（仅Thinking模型，纯本地Canvas绘制）
│   └── 本地持久化存储（MySQL数据库）🆕
├── 🎬 视频生成模块
│   ├── 多图上传（1-5张）
│   ├── 时长设置（3-10秒）
│   ├── 转场效果（淡入淡出/滑动/无转场）
│   ├── 智能字幕生成（100+话术库）
│   ├── 虚拟形象讲解（仅支持VRM形象）
│   │   ├── 顶级VRoid形象（专业级）
│   │   │   ├── 52种真实表情系统（expressionManager驱动）
│   │   │   ├── 15种精确口型同步（aa/ih/ou/ee）
│   │   │   ├── 静止姿态优化（身体静止）
│   │   │   ├── 脸部特写模式（Z轴-1.2）
│   │   │   ├── 男女双性别自动匹配
│   │   │   └── 1200×1200超高清渲柑
│   │   └── 高级Q版形象（动画风格）
│   │       ├── 视觉欺骗模拟口型（Y轴拉伸）
│   │       ├── 自然动画效果（呼吸/眩眼/摆动）
│   │       ├── 大半上身展示
│   │       └── 1200×1200渲柑
│   ├── 语音配音功能（火山引擎 TTS）
│   └── 视频下载
├── ⚡ 性能优化 
│   ├── 智能超时机制（60s/30s）
│   ├── Token优化（对话历史限制）
│   └── 防御性检查（API验证）
└── 🚀 部署与运维
    ├── GitHub 版本控制
    ├── Vercel 自动部署
    └── CI/CD 自动化流程
```

### 2.2 详细功能列表

#### 2.2.1 AI 图片生成功能

**功能描述**：
- 上传商品图片（支持拖拽和点击上传）
- 选择 AI 模型（4个豆包模型可选）
- 输入需求或使用快捷按钮
- AI 自动生成商品文案
- 一键生成带水印的装饰宣传图

**支持的生成类型**：
1. **商品标题** - 吸引人的营销标题
2. **商品卖点** - 突出产品特点的文案
3. **装饰宣传图** - 两种模式可选
   - **普通装饰模式**：促销徽章 + 100+ 装饰贴纸 + 价格标签 + 光效
   - **高级定制模式** 🆕：
     - AI 智能分析商品（名称/产地/卖点/说明）
     - 文字装饰框动态生成
     - **4种边框风格**（仅 Thinking 模型，纯本地Canvas绘制）：
       - 简约边框：白灰双线
       - 国潮边框：红金渐变+四角菱形装饰
       - 渐变边框：紫粉蓝渐变+发光阴影
       - 豪华边框：三层金色+四角宝石装饰
     - 边框宽度 25px，明显视觉区分
     - 智能反馈优化（3次后提示升级）
     - 边框状态智能保留
     - **本地持久化存储**：MySQL自动保存所有生成记录 🆕

#### 2.2.2 视频生成功能

**功能描述**：
- 批量上传 1-5 张图片
- 自定义视频时长（3-10 秒可调）
- 选择转场效果（淡入淡出/滑动/无转场）
- 智能字幕生成（100+ 话术库，支持自定义）
- **虚拟形象讲解** 🆕（仅支持VRM形象）：
  - **⭐ 顶级VRoid形象**（专业级）：
    - VRoid Studio专业3D虚拟人物（Three.js渲染）
    - **52种真实表情系统**：真实的 expressionManager 驱动，非几何变换
    - **15种精确口型同步**：aa/ih/ou/ee 等标准口型，非Y轴拉伸
    - **静止姿态优化**：配音时仅表情口型变，身体静止不旋转
    - **脸部特写模式**：摄像机Z轴-1.2，聚焦面部表情细节
    - **男女双性别自动匹配**：根据配音声音智能识别（女声→红裙女孩，男声→西装男生）
    - **1200×1200超高清渲染**：专业级视觉质量
  - **🎨 高级Q版形象**（动画风格）：
    - Q版3D虚拟人物（Three.js渲染）
    - **视觉欺骗技术**：静态VRM，Y轴拉伸模拟口型
    - **自然动画效果**：呼吸/眨眼/左右摆动/前后摆动/飘动
    - **大半上身展示** + 1200×1200渲染
    - **男女双性别形象**
  - **普通2D形象**：PNG静态图片展示
- 语音配音功能（火山引擎 TTS，男声/女声）
  - **真实时长获取**（从API返回，禁止硬编码）
  - 音视频精准同步输出
- 一键下载 WebM 格式视频

**技术亮点**：
- ✅ 纯前端音视频生成，无需后端处理
- ✅ Canvas + MediaRecorder + Web Audio API
- ✅ **Three.js + @pixiv/three-vrm** 🆕（VRM虚拟形象渲染）
- ✅ 火山引擎 TTS 语音合成
- ✅ 音视频同步输出
- ✅ 实时预览
- ✅ 支持移动端

#### 2.2.3 多模型切换

**可用模型**：
| 模型名称 | 特点 | 适用场景 |
|---------|------|---------||
| Doubao-1.5-pro-32k | 高性能，长文本 | 复杂商品描述 |
| Doubao-1.5-pro-4k | 标准版，快速响应 | 常规文案生成 |
| Doubao-lite-32k | 轻量版，经济实惠 | 简单标题生成 |
| Doubao-lite-4k | 基础版，快速处理 | 快速测试 |
| Doubao-vision | 多模态，图文理解 | 高级装饰图生成 |
| Doubao-thinking-vision | 思维链，深度推理 | 复杂场景分析 |

#### 2.2.4 智能反馈优化机制 🆕

**功能描述**：
- 用户可对 AI 生成结果提供反馈
- AI 根据反馈重新分析和生成
- **Vision 模型**：
  - 支持 3 次不满意优化
  - 3次后提示升级到 Thinking 模型
  - 独立反馈UI（橙色区域）
  - 无边框选择功能
- **Thinking 模型**：
  - 无限次优化
  - 4种边框风格可选
  - 智能保留用户的边框选择设置
- **智能超时机制** ：
  - Thinking 模型：60秒超时
  - 普通模型：30秒超时
  - AbortController 超时控制
  - 友好的超时提示
- **性能优化** ：
  - 对话历史限制为最近6轮
  - Token消耗节省89%
  - API响应格式验证
  - 防御性检查增强

---

## 3. 技术架构

### 3.1 技术栈

**前端框架**：
- Next.js 14 (App Router)
- React 18
- TypeScript

**样式方案**：
- Tailwind CSS
- 响应式设计（支持桌面和移动端）
- **抖音黑色主题** （深色背景，现代化设计）

**AI 服务**：
- 火山引擎豆包大模型（6个模型）
- 原生 Fetch API 调用

**音视频处理**：
- Canvas API（图像处理）
- MediaRecorder API（视频录制）
- Web Audio API（音频合成）
- **Three.js + @pixiv/three-vrm** （VRM虚拟形象渲染）
- 火山引擎 TTS（语音合成，真实时长获取）
- WebM 格式输出

**部署方案**：
- Vercel（生产环境）
- GitHub（代码托管）
- CI/CD 自动化

### 3.2 架构图

```
┌─────────────────────────────────────────────────┐
│              用户浏览器                           │
│  https://e-commerce-ai-tool.vercel.app          │
└───────────────────┬─────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────┐
│           Next.js 前端应用                        │
│  ┌─────────────────────────────────────────┐   │
│  │   App Router 页面                        │   │
│  │   - page.tsx (主界面)                    │   │
│  │   - layout.tsx (全局布局)                │   │
│  └─────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────┐   │
│  │   API 路由                               │   │
│  │   - /api/chat (AI 对话接口)              │   │
│  └─────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────┐   │
│  │   工具库                                  │   │
│  │   - imageGenerator (图片处理)            │   │
│  │   - videoGenerator (视频生成)            │   │
│  │   - ttsService (语音合成)                │   │
│  │   - volcengine (AI 调用)                 │   │
│  └─────────────────────────────────────────┘   │
└───────────────────┬─────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────┐
│         火山引擎 AI 服务                          │
│   豆包模型（6个）:                               │
│   - Doubao-1.5-pro-32k                          │
│   - Doubao-1.5-pro-4k                           │
│   - Doubao-lite-32k                             │
│   - Doubao-lite-4k                              │
│   - Doubao-vision（多模态）🆕                    │
│   - Doubao-thinking-vision（思维链）🆕          │
│   TTS 服务:                                      │
│   - BV001（男声）                                │
│   - BV002（女声）                                │
│   - 真实时长返回 🆕                              │
└─────────────────────────────────────────────────┘
```

### 3.3 CI/CD 流程

```
开发者本地修改代码
        ↓
    git commit
        ↓
 git push to GitHub
        ↓
GitHub 触发 Webhook
        ↓
Vercel 自动检测更新
        ↓
  自动执行 npm install
        ↓
  自动执行 npm run build
        ↓
    构建成功
        ↓
 自动部署到 Edge Network
        ↓
  生产环境自动更新
        ↓
   用户访问新版本
```

---

## 4. 功能演示

### 4.1 AI 图片生成演示

#### 步骤 1：上传商品图片

**方式一：拖拽上传**
1. 打开应用，选择"AI 图片生成"模式
2. 将商品图片拖拽到上传区域
3. 图片自动预览

**方式二：点击上传**
1. 点击"点击上传"按钮
2. 选择本地图片文件
3. 确认上传

#### 步骤 2：选择 AI 模型

在"AI 模型选择"区域：
- 查看 6 个可用模型
  - 4 个文本模型（适合普通文案生成）
  - 2 个多模态模型（适合高级装饰图生成）
- 点击选择适合的模型
- 系统显示当前选择的模型

#### 步骤 3：生成商品文案

**方式一：使用快捷按钮**
- 点击"生成商品标题"
- 点击"生成商品卖点"
- AI 自动生成对应文案

**方式二：自定义输入**
- 在输入框输入需求
- 例如："生成一段强调性价比的商品描述"
- 点击"发送"

#### 步骤 4：生成装饰宣传图

**普通装饰模式**：
1. 输入"生成装饰宣传图"
2. 选择"普通装饰"
3. 等待处理（约 3-5 秒）
4. 查看效果：促销徽章 + 100+ 贴纸 + 光效

**高级定制模式（需 Vision/Thinking 模型）** ：
1. 确保已选择 Vision 或 Thinking-Vision 模型
2. 输入"生成装饰宣传图"
3. 选择"高级定制"
4. AI 自动分析商品图片（10-30 秒）
5. 生成文字说明装饰框
6. **边框选择（仅 Thinking 模型）**：
   - 简约边框：白灰双线，简洁大方
   - 国潮边框：红金渐变+四角菱形装饰
   - 渐变边框：紫粉蓝渐变+发光阴影
   - 豪华边框：三层金色+四角宝石装饰
7. 如不满意，可提供反馈重新生成
   - Vision 模型：最多3次优化，3次后提示升级
   - Thinking 模型：无限次优化，智能保留边框选择

**效果展示**：
- ✅ 图片自动添加"抖音电商前端训练营"水印
- ✅ 水印位置：右下角，24px 字体
- ✅ 水印样式：白色文字 + 阴影，清晰可见
- ✅ 高级模式：商品名 + 产地 + 卖点 + 说明
- ✅ 边框风格（Thinking）：简约/国潮/渐变/豪华，25px宽度，明显视觉区分
- ✅ 智能超时：Thinking 60s, Vision 30s
- ✅ 性能优化：对话历史限制6轮，节省89% token

### 4.2 视频生成演示

#### 步骤 1：切换到视频生成模式

点击顶部"视频生成"按钮

#### 步骤 2：上传多张图片

**方式一：拖拽上传**
- 将多张图片拖拽到上传区域
- 支持一次拖拽多张（最多5张）

**方式二：点击上传**
- 点击上传按钮
- 按住 Ctrl/Cmd 多选图片
- 确认上传

**已上传图片管理**：
- 查看缩略图预览
- 显示图片序号（1、2、3...）
- 点击删除按钮移除图片

#### 步骤 3：配置视频参数

**时长设置**：
- 拖动滑块选择时长（3-10 秒）
- 实时显示当前时长

**转场效果**：
- 淡入淡出（推荐）
- 滑动
- 无转场

#### 步骤 4：配置字幕和虚拟形象 

**虚拟形象选择**：
- **高级VRM 3D形象**（推荐）：
  - Q版3D虚拟人物（Three.js渲染）
  - 视觉欺骗模拟说话（通过动画模拟口型）
  - 根据音频长短自动控制动作节奏
  - 自然动画效果：呼吸、眨眼、摆动、飘动
  - 目前支持女性形象
- **普通2D形象**：PNG静态图片展示

**自动生成字幕（推荐）**：
- 系统智能生成讲解文案（100+ 话术库）
- 根据图片数量智能组合：
  - 1 张：开场话术
  - 2 张：开场 + 促销
  - 3 张：开场 + 特点 + 促销
  - 4-5 张：完整营销话术组合
- 涵盖 10+ 类别：庆祝、促销、品质、场景等

**自定义字幕**：
- 勾选"自定义字幕"
- 为每张图片输入讲解文案
- 支持中文、英文、emoji

**视频配音功能（可选）**：
- 勾选“启用语音配音”
- 选择音色：通用男声 / 通用女声
- 使用火山引擎 TTS 合成
- 自动与视频同步

**虚拟形象选择** ：
- **⭐ 顶级VRoid形象**（专业级）：
  - VRoid Studio专业3D虚拟人物
  - **52种真实表情系统**：真实的 expressionManager 驱动，blink/happy/neutral 等表情，非几何变换
  - **15种精确口型同步**：aa/ih/ou/ee 等标准口型，配音时循环切换，配音结束自动恢复微笑，非Y轴拉伸
  - **静止姿态优化**：配音时仅表情和口型变化，身体完全静止（不旋转、不摇摆），手臂自然垂放，正面朝向摄像机
  - **脸部特写模式**：摄像机Z轴-1.2更近，聚焦面部表情和口型细节，清晰展示眨眼和表情变化
  - **男女双性别自动匹配**：根据配音声音智能识别性别，女声→红裙女孩，男声→西装男生
  - **1200×1200超高清渲染**：专业级视觉质量，高质量图像插值
  - **音频时长精准控制**：从TTS API获取真实时长，配音停止时人物立即停止
- **🎨 高级Q版形象**（动画风格）：
  - Q版3D虚拟人物（Three.js渲染）
  - **视觉欺骗技术**：静态VRM模型，Y轴拉伸模拟嘴巴张合，视觉上营造说话感
  - **自然动画效果**：呼吸动画（胸部起伏）、眨眼动画、左右轻微摆动、前后适度摆动、随风飘动效果
  - **大半上身展示** + 1200×1200渲柑
  - **男女双性别形象**
  - **音频长短控制动作**：根据TTS真实时长同步动画节奏
- **普通2D形象**：PNG静态图片展示

#### 步骤 5：生成视频

1. 点击"生成视频"按钮
2. 等待处理：
   - 无配音：约 10-20 秒
   - 有配音：约 20-40 秒（含语音合成）
3. 进度提示：正在生成视频...
4. 配音版会显示：正在合成语音...
5. 生成完成，自动显示视频预览

#### 步骤 6：预览与下载

- 在线播放预览视频
- 检查转场效果和字幕
- 点击"下载视频"保存 WebM 格式文件

**视频特点**：
- ✅ 分辨率：根据原图自动适配
- ✅ 格式：WebM（VP9 视频编码 + Opus 音频编码）
- ✅ 字幕：底部居中，14px 字体，黑色背景白色文字
- ✅ 转场流畅自然
- ✅ 配音：火山引擎 TTS 高质量语音
- ✅ 音视频同步：精准对齐

---

## 5. 部署与CI/CD

### 5.1 项目部署流程

#### 5.1.1 GitHub 仓库配置

1. **初始化 Git**
   ```bash
   cd e-commerce-ai-tool
   git init
   git add .
   git commit -m "feat: 电商AI工具完整版"
   ```

2. **推送到 GitHub**
   ```bash
   git remote add origin https://github.com/niuyiduo/e-commerce-ai-tool.git
   git push -u origin main
   ```

#### 5.1.2 Vercel 部署配置

1. **连接 GitHub**
   - 访问 vercel.com
   - 使用 GitHub 账号登录
   - 授权 Vercel 访问仓库

2. **导入项目**
   - 选择 e-commerce-ai-tool 仓库
   - Vercel 自动识别 Next.js 项目

3. **配置环境变量**
   - `VOLCENGINE_API_KEY` - 火山引擎 API 密钥
   - `VOLCENGINE_ENDPOINT_ID` - 默认端点 ID
   - `VOLCENGINE_ENDPOINT_PRO_32K` - Pro 32K 端点
   - `VOLCENGINE_ENDPOINT_PRO_4K` - Pro 4K 端点
   - `VOLCENGINE_ENDPOINT_LITE_32K` - Lite 32K 端点
   - `VOLCENGINE_ENDPOINT_LITE_4K` - Lite 4K 端点
   - `VOLCENGINE_ENDPOINT_VISION` - Vision 多模态端点
   - `VOLCENGINE_ENDPOINT_THINKING_VISION` - Thinking Vision 端点
   - `VOLCENGINE_TTS_APP_ID` - TTS 应用 ID
   - `VOLCENGINE_TTS_TOKEN` - TTS 访问令牌

4. **部署**
   - 点击 Deploy 按钮
   - 等待构建（约 2-3 分钟）
   - 获取生产环境 URL

### 5.2 CI/CD 自动化流程

**配置完成后，实现完全自动化**：

```
开发者工作流：
1. 本地修改代码
2. git add . && git commit -m "更新说明"
3. git push origin main
4. ✅ 自动触发部署

Vercel 自动执行：
1. 检测 GitHub 更新
2. 拉取最新代码
3. 安装依赖 (npm install)
4. 构建项目 (npm run build)
5. 部署到 Edge Network
6. 更新生产环境
7. 发送部署通知
```

**部署时间**：1-3 分钟  
**回滚支持**：一键回滚到任何历史版本  
**环境隔离**：Production / Preview / Development

### 5.3 生产环境信息

- **生产 URL**：https://e-commerce-ai-tool.vercel.app
- **GitHub 仓库**：https://github.com/niuyiduo/e-commerce-ai-tool
- **部署平台**：Vercel (Edge Network)
- **CDN 加速**：全球 CDN 节点
- **SSL 证书**：自动配置 HTTPS

---

## 6. 使用指南

### 6.1 快速开始

#### 访问应用
打开浏览器，访问：
```
https://e-commerce-ai-tool.vercel.app
```

#### 选择功能模式
- 🖼️ **AI 图片生成** - 生成商品文案和宣传图
- 🎬 **视频生成** - 合成产品讲解视频

### 6.2 AI 图片生成使用指南

#### 第一步：准备素材
- 准备 1 张商品图片
- 支持格式：JPG、PNG、WebP
- 建议尺寸：800x800 以上

#### 第二步：上传图片
- 拖拽图片到上传区域
- 或点击上传按钮选择文件

#### 第三步：选择模型
根据需求选择合适的 AI 模型：
- **普通文案生成**：
  - 复杂商品：Doubao-1.5-pro-32k
  - 常规商品：Doubao-1.5-pro-4k
  - 简单文案：Doubao-lite 系列
- **高级装饰图生成**：
  - 推荐：Doubao-thinking-vision（思维链，推理能力强）
  - 备选：Doubao-vision（多模态，图文理解）

#### 第四步：生成内容
- 点击快捷按钮或输入自定义需求
- 等待 AI 生成结果
- 查看生成的文案

#### 第五步：生成宣传图
- 输入"生成装饰宣传图"
- 选择装饰模式（普通 / 高级定制）
- 等待图片生成
- 高级模式可提供反馈优化
- 下载带水印的宣传图

### 6.3 视频生成使用指南

#### 第一步：准备素材
- 准备 1-5 张商品图片
- 建议同系列商品或不同角度
- 支持格式：JPG、PNG

#### 第二步：上传图片
- 切换到"视频生成"模式
- 批量上传图片（最多5张）
- 查看预览并确认顺序

#### 第三步：设置参数
- **时长**：根据内容选择 3-10 秒
- **转场**：推荐使用"淡入淡出"
- **字幕**：自动生成或自定义

#### 第四步：生成视频
- 点击"生成视频"按钮
- 等待处理（10-30秒）
- 预览视频效果

#### 第五步：下载视频
- 确认视频质量
- 点击"下载视频"
- 保存到本地

### 6.4 常见问题

**Q1：上传图片失败？**
- 检查图片格式是否正确
- 确保图片大小不超过 10MB
- 尝试刷新页面重新上传

**Q2：AI 生成速度慢？**
- Pro 模型处理时间较长（5-10秒）
- 可切换到 Lite 模型加快速度
- 网络不稳定会影响速度

*Q3：视频没有声音？**
- 检查是否勾选"启用语音配音"
- 如未勾选，生成的是静音视频
- 字幕已包含讲解信息
- 可重新生成并启用配音

**Q4：视频格式兼容性？**
- WebM 格式主流浏览器支持
- 移动端可能需要转换格式
- 推荐使用格式转换工具

---

## 7. 项目亮点

### 7.1 技术亮点

#### ✨ 纯前端音视频生成
- **无需后端**：Canvas + MediaRecorder + Web Audio 实现
- **语音合成**：火山引擎 TTS 高质量配音
- **音视频同步**：精准对齐输出
- **实时预览**：所见即所得
- **性能优化**：异步处理，不阻塞 UI

#### ✨ 多模型智能切换
- **6 个 AI 模型**：包含文本和多模态模型
- **多模态能力**：Vision 模型支持图文理解
- **思维链推理**：Thinking Vision 模型深度分析
- **统一 API Key**：一个密钥管理多个端点
- **动态映射**：根据模型名自动选择端点

#### ✨ 完整 CI/CD
- **零配置部署**：Vercel 自动识别 Next.js
- **秒级更新**：代码推送即触发部署
- **全球加速**：Edge Network 分发

#### ✨ 响应式设计
- **移动端适配**：支持手机、平板访问
- **触摸优化**：拖拽上传兼容触摸屏
- **性能优化**：Tailwind CSS 按需加载

### 7.2 功能亮点

#### 🎯 用户体验优化
- **拖拽上传**：更直观的交互方式
- **快捷按钮**：常用功能一键触达
- **实时反馈**：加载动画、进度提示
- **错误提示**：友好的错误信息

#### 🎯 智能化程度高
- **多模态 AI**：Vision 模型图文理解能力
- **思维链推理**：Thinking 模型深度分析
- **智能反馈**：根据用户反馈优化结果
- **自动水印**：无需手动添加
- **智能字幕**：100+ 话术库自动生成
- **语音配音**：TTS 自动合成

#### 🎯 可扩展性强
- **模块化设计**：imageGenerator、videoGenerator、ttsService 独立
- **类型安全**：TypeScript 全覆盖
- **环境变量管理**：支持多环境配置
- **AI 模型扩展**：易于接入新模型

### 7.3 商业价值

#### 💰 降本增效
- **人力成本**：减少 80% 文案撰写时间
- **设计成本**：自动生成宣传图
- **视频成本**：无需专业拍摄团队

#### 💰 提升转化率
- **专业文案**：AI 优化的营销话术
- **视觉冲击**：精美的宣传图
- **视频展示**：更直观的产品展示

#### 💰 规模化应用
- **批量处理**：支持多商品快速生成
- **标准化**：统一的素材风格
- **品牌一致性**：固定水印、统一模板

---

# 8. 开发排期与时间线

### 8.1 项目开发周期

**总开发时长**：3 周左右

**开发模式**：迭代开发，每周一个里程碑

### 8.2 详细排期表

#### Week 1：需求分析与技术选型

**时间**：第 1 周  
**目标**：明确项目需求，完成技术方案设计

**主要任务**：
- ✅ 分析电商素材生成场景需求
- ✅ 调研主流 AI 服务（火山引擎、OpenAI、文心一言）
- ✅ 选定 Next.js 14 + TypeScript 技术栈
- ✅ 确定使用火山引擎豆包大模型
- ✅ 设计系统架构和功能模块

**产出**：
- 技术方案文档
- 系统架构图
- 功能清单

---

#### Week 1：项目初始化与基础搭建

**时间**：第 1 周  
**目标**：搭建项目框架，实现基础功能

**主要任务**：
- ✅ 使用 create-next-app 初始化项目
- ✅ 配置 TypeScript、ESLint、Prettier
- ✅ 集成 Tailwind CSS 样式框架
- ✅ 搭建基础 UI 布局（响应式设计）
- ✅ 实现图片上传功能（点击上传）
- ✅ 实现拖拽上传功能（Drag and Drop API）
- ✅ 添加图片预览功能

**产出**：
- 完整的项目框架
- 可运行的基础应用
- 图片上传模块

**技术难点**：
- 拖拽上传跨浏览器兼容性处理
- 响应式布局适配

---

#### Week 1：AI 对话功能开发

**时间**：第 1 周  
**目标**：实现与火山引擎 AI 的对话功能

**主要任务**：
- ✅ 注册火山引擎账号，获取 API 密钥
- ✅ 创建 `/api/chat` 后端 API 路由
- ✅ 实现火山引擎 API 调用逻辑（volcengine.ts）
- ✅ 开发对话界面 UI
- ✅ 实现消息列表展示
- ✅ 添加快捷按钮（生成标题、生成卖点）
- ✅ 实现商品文案生成功能

**产出**：
- AI 对话模块
- 文案生成功能
- `/api/chat` API 接口

**技术难点**：
- API 请求错误处理
- 对话历史管理

---

#### Week 1：图片装饰功能开发

**时间**：第 1 周  
**目标**：实现普通装饰模式的宣传图生成

**主要任务**：
- ✅ 开发 Canvas 图片处理模块（imageGenerator.ts）
- ✅ 实现促销徽章绘制（新品、热卖等）
- ✅ 添加 100+ 装饰贴纸（Emoji + 图标）
- ✅ 实现价格标签功能
- ✅ 添加光晕特效
- ✅ 实现水印功能（右下角"抖音电商前端训练营"）
- ✅ 实现图片下载功能

**产出**：
- 图片装饰模块
- 普通装饰模式
- 水印功能

**技术难点**：
- Canvas 图层叠加
- 随机装饰元素分布算法

---

#### Week 2：视频生成功能开发

**时间**：第 2 周  
**目标**：实现多图合成产品讲解视频

**主要任务**：
- ✅ 实现多图上传管理（最多 5 张）
- ✅ 开发 MediaRecorder 视频录制功能
- ✅ 实现转场效果（淡入淡出、滑动、无转场）
- ✅ 添加字幕功能（14px 字体，底部居中）
- ✅ 实现视频时长配置（3-10 秒）
- ✅ 开发视频预览功能
- ✅ 实现视频下载（WebM 格式）

**产出**：
- 视频生成模块（videoGenerator.ts）
- 完整的视频生成功能

**技术难点**：
- MediaRecorder API 兼容性
- 转场动画实现
- 视频编码优化

---

#### Week 3：语音配音功能开发

**时间**：第 3 周  
**目标**：实现 TTS 语音合成与音视频同步

**主要任务**：
- ✅ 集成火山引擎 TTS API
- ✅ 创建 `/api/tts` 后端 API 路由
- ✅ 开发语音合成模块（ttsService.ts）
- ✅ 实现音色选择（通用男声/女声）
- ✅ 开发 Web Audio API 音频处理
- ✅ 实现音视频同步逻辑
- ✅ 添加智能字幕生成（100+ 话术库）

**产出**：
- TTS 语音模块
- `/api/tts` API 接口
- 音视频同步功能

**技术难点**：
- 音视频精准同步
- Web Audio API 音频混音
- 字幕时间轴计算

---

#### Week 2：多模型切换与高级功能

**时间**：第 2 周  
**目标**：实现 6 个 AI 模型切换和高级装饰图

**主要任务**：
- ✅ 实现 6 个 AI 模型动态切换
  - Doubao-1.5-pro-32k
  - Doubao-1.5-pro-4k
  - Doubao-lite-32k
  - Doubao-lite-4k
  - Doubao-vision（多模态）
  - Doubao-thinking-vision（思维链）
- ✅ 开发高级定制装饰图功能
- ✅ 实现 Vision 模型图文理解
- ✅ 添加智能反馈优化机制
- ✅ 实现 4 种边框风格（简约/国潮/渐变/豪华）
- ✅ 优化水印和字幕显示

**产出**：
- 多模型切换功能
- 高级定制装饰图模式
- 智能反馈系统

**技术难点**：
- 多端点动态映射
- Vision 模型调用
- 思维链推理优化

---

#### Week 1-3：部署上线与优化

**时间**：第 1-3 周  
**目标**：完成项目部署和文档编写

**主要任务**：
- ✅ 代码推送到 GitHub
- ✅ 配置 Vercel 自动部署
- ✅ 设置环境变量
- ✅ 配置 CI/CD 流程
- ✅ 性能优化（代码分割、懒加载）
- ✅ 移动端适配优化
- ✅ 编写 README 文档
- ✅ 编写项目演示文档
- ✅ 制作 PPT 演示文稿
- ✅ 线上测试与 Bug 修复

**产出**：
- 生产环境应用（https://e-commerce-ai-tool.vercel.app）
- GitHub 仓库（https://github.com/niuyiduo/e-commerce-ai-tool）
- 完整项目文档

**技术难点**：
- Vercel 环境变量配置
- 全球 CDN 加速优化

---

### 8.3 关键里程碑

| 时间节点 | 里程碑 | 完成度 |
|---------|--------|-------|
| Week 1 结束 | 完成基础 AI 对话功能 | ✅ 
| Week 1 结束 | 完成图片和视频生成核心功能 | ✅ 
| Week 2 结束 | 完成语音配音功能 | ✅ 
| Week 3 结束 | 完成所有高级功能 | ✅
| Week 1-3 结束 | 项目上线并投入使用 | ✅

---

### 8.4 开发团队与分工

**开发人员**：牛一朵（独立完成）

**职责分工**：
- 前端开发
- 后端 API 开发
- UI/UX 设计
- 项目部署
- 文档编写

---

## 9. API 接口详细文档

### 9.1 接口概览

本项目基于 Next.js App Router，提供 2 个核心 RESTful API 接口：

1. **AI 对话接口** - `/api/chat`
2. **语音合成接口** - `/api/tts`

所有接口均部署在 Vercel Edge Network，支持全球访问。

---

### 9.2 AI 对话接口

#### 基本信息

**接口名称**：AI 对话与图片分析  
**请求方式**：`POST`  
**接口地址**：`/api/chat`  
**Content-Type**：`application/json`

#### 功能说明

该接口用于：
1. 与 AI 进行对话交互
2. 上传商品图片进行分析
3. 生成商品文案（标题、卖点等）
4. 高级定制装饰图分析（需 Vision 模型）
5. 智能反馈优化

#### 请求参数

**请求体结构**：
```typescript
interface ChatRequest {
  messages: Message[];           // 对话消息列表（必填）
  image?: string;                // Base64 图片（可选）
  model?: string;                // AI 模型名称（可选）
  feedback?: string;             // 用户反馈（可选）
  previousAnalysis?: string;     // 上次分析结果（可选）
  borderStyle?: string;          // 边框样式（可选）
}

interface Message {
  role: 'user' | 'assistant';    // 消息角色
  content: string;               // 消息内容
}
```

**参数说明**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `messages` | Array | ✅ | 对话消息数组，至少包含一条 user 消息 |
| `messages[].role` | String | ✅ | 消息角色：`user`（用户）或 `assistant`（AI） |
| `messages[].content` | String | ✅ | 消息文本内容 |
| `image` | String | ⭕ | Base64 编码的图片数据，格式：`data:image/jpeg;base64,...` |
| `model` | String | ⭕ | AI 模型名称，默认使用 `VOLCENGINE_ENDPOINT_ID` 配置 |
| `feedback` | String | ⭕ | 用户对上次生成结果的反馈意见 |
| `previousAnalysis` | String | ⭕ | 上次 AI 分析的结果，用于优化 |
| `borderStyle` | String | ⭕ | 边框样式选择：`simple`/`traditional`/`gradient`/`luxury` |

#### 支持的 AI 模型

| 模型名称 | 说明 | 适用场景 |
|---------|------|----------|
| `Doubao-1.5-pro-32k` | 高性能长文本模型 | 复杂商品描述、长文案生成 |
| `Doubao-1.5-pro-4k` | 标准快速响应模型 | 常规文案生成 |
| `Doubao-lite-32k` | 轻量经济模型 | 简单标题生成 |
| `Doubao-lite-4k` | 基础快速模型 | 快速测试 |
| `Doubao-vision` | 多模态图文理解模型 | 高级装饰图分析 |
| `Doubao-thinking-vision` | 思维链深度推理模型 | 复杂场景深度分析 |

#### 请求示例

**示例 1：生成商品标题**
```json
{
  "messages": [
    {
      "role": "user",
      "content": "生成商品标题"
    }
  ],
  "image": "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
  "model": "Doubao-1.5-pro-32k"
}
```

**示例 2：高级定制装饰图分析（Vision 模型）**
```json
{
  "messages": [
    {
      "role": "user",
      "content": "生成装饰宣传图"
    }
  ],
  "image": "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
  "model": "Doubao-vision",
  "borderStyle": "gradient"
}
```

**示例 3：智能反馈优化**
```json
{
  "messages": [
    {
      "role": "user",
      "content": "重新生成"
    }
  ],
  "image": "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
  "model": "Doubao-thinking-vision",
  "feedback": "文字太多了，简洁一些",
  "previousAnalysis": "{\"商品名\":\"有机苹果\",...}",
  "borderStyle": "simple"
}
```

#### 响应结果

**成功响应**：
```typescript
interface ChatResponse {
  content: string;               // AI 生成的回复内容
}
```

**响应示例 1：文案生成**
```json
{
  "content": "【限时特惠】高端商务笔记本电脑 - 轻薄便携 超长续航 办公利器"
}
```

**响应示例 2：高级装饰图分析（JSON 格式）**
```json
{
  "content": "{\"商品名\":\"新疆阿克苏有机苹果\",\"产地\":\"新疆阿克苏\",\"卖点\":\"高海拔种植 日照充足 天然有机\",\"说明\":\"精选优质果源，每一颗都经过严格筛选，确保品质上乘。富含维生素和矿物质，是您健康生活的首选。\"}"
}
```

**错误响应**：
```typescript
interface ErrorResponse {
  error: string;                 // 错误信息描述
}
```

**错误示例**：
```json
{
  "error": "Missing required messages"
}
```

#### HTTP 状态码

| 状态码 | 说明 |
|-------|------|
| `200` | 请求成功 |
| `400` | 请求参数错误（缺少必填字段或格式错误） |
| `500` | 服务器内部错误（AI 服务调用失败） |

#### 注意事项

1. **图片格式**：仅支持 JPEG、PNG、WebP 格式
2. **图片大小**：建议不超过 10MB
3. **Base64 编码**：图片需包含完整的 Data URL 前缀
4. **Vision 模型**：高级定制模式必须使用 Vision 或 Thinking-Vision 模型
5. **反馈优化**：
   - Vision 模型：最多 3 次优化
   - Thinking-Vision 模型：无限次优化
6. **响应时间**：
   - 文本模型：5-10 秒
   - Vision 模型：10-30 秒
   - Thinking-Vision 模型：15-40 秒

---

### 9.3 语音合成接口

#### 基本信息

**接口名称**：TTS 文本转语音  
**请求方式**：`POST`  
**接口地址**：`/api/tts`  
**Content-Type**：`application/json`

#### 功能说明

该接口用于：
1. 将文本转换为语音（Text-to-Speech）
2. 生成视频配音
3. 支持多种音色选择

#### 请求参数

**请求体结构**：
```typescript
interface TTSRequest {
  text: string;                  // 要合成的文本（必填）
  voice?: string;                // 音色选择（可选）
}
```

**参数说明**：

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| `text` | String | ✅ | 要转换为语音的文本内容 |
| `voice` | String | ⭕ | 音色 ID，默认：`BV001_streaming`（通用女声） |

#### 支持的音色

| 音色 ID | 说明 | 特点 |
|---------|------|------|
| `BV001_streaming` | 通用女声 | 温柔亲切，适合产品介绍 |
| `BV002_streaming` | 通用男声 | 沉稳大气，适合品牌宣传 |

#### 请求示例

**示例 1：使用默认女声**
```json
{
  "text": "欢迎来到我们的店铺，这款产品性价比超高，限时优惠中！"
}
```

**示例 2：使用男声**
```json
{
  "text": "新疆阿克苏有机苹果，高海拔种植，日照充足，天然有机。",
  "voice": "BV002_streaming"
}
```

#### 响应结果

**成功响应**：
- **Content-Type**: `audio/mpeg`
- **Body**: 二进制音频流（MP3 格式）

**音频参数**：
- 格式：MP3
- 采样率：24000 Hz
- 比特率：48 kbps
- 声道：单声道

**错误响应**：
```json
{
  "error": "Missing required text"
}
```

#### HTTP 状态码

| 状态码 | 说明 |
|-------|------|
| `200` | 请求成功，返回音频流 |
| `400` | 请求参数错误 |
| `500` | 服务器内部错误（TTS 服务调用失败） |

#### 使用示例（前端）

``typescript
// 调用 TTS 接口
const response = await fetch('/api/tts', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    text: '这是一段测试文本',
    voice: 'BV002_streaming'
  })
});

if (response.ok) {
  // 将响应转为 Blob
  const audioBlob = await response.blob();
  
  // 创建音频 URL
  const audioUrl = URL.createObjectURL(audioBlob);
  
  // 播放音频
  const audio = new Audio(audioUrl);
  audio.play();
  
  // 或者用于视频配音
  // const audioContext = new AudioContext();
  // const audioBuffer = await audioContext.decodeAudioData(await audioBlob.arrayBuffer());
}
```

#### 注意事项

1. **文本长度**：建议不超过 500 字符，过长可能导致超时
2. **语言支持**：支持中文、英文及中英混合
3. **特殊字符**：数字会自动转换为语音（如"100"读作"一百"）
4. **标点符号**：会影响语音的停顿和语调
5. **响应时间**：
   - 短文本（< 50 字）：1-2 秒
   - 中等文本（50-200 字）：3-5 秒
   - 长文本（200-500 字）：5-10 秒
6. **并发限制**：建议不超过 10 个并发请求

---

### 9.4 环境变量配置

所有 API 接口依赖以下环境变量，需在项目根目录的 `.env.local` 文件中配置：

```env
# ========== AI 服务配置 ==========
# 火山引擎 API 密钥（所有模型共用）
VOLCENGINE_API_KEY=your_api_key_here

# 默认端点 ID（未指定模型时使用）
VOLCENGINE_ENDPOINT_ID=your_default_endpoint_id

# ========== 多模型端点配置（可选） ==========
# Doubao-1.5-pro-32k 端点 ID
VOLCENGINE_ENDPOINT_PRO_32K=your_pro_32k_endpoint_id

# Doubao-1.5-pro-4k 端点 ID
VOLCENGINE_ENDPOINT_PRO_4K=your_pro_4k_endpoint_id

# Doubao-lite-32k 端点 ID
VOLCENGINE_ENDPOINT_LITE_32K=your_lite_32k_endpoint_id

# Doubao-lite-4k 端点 ID
VOLCENGINE_ENDPOINT_LITE_4K=your_lite_4k_endpoint_id

# Doubao-vision 多模态端点 ID
VOLCENGINE_ENDPOINT_VISION=your_vision_endpoint_id

# Doubao-thinking-vision 思维链端点 ID
VOLCENGINE_ENDPOINT_THINKING_VISION=your_thinking_vision_endpoint_id

# ========== TTS 服务配置 ==========
# TTS 应用 ID
VOLCENGINE_TTS_APP_ID=your_tts_app_id

# TTS 访问令牌
VOLCENGINE_TTS_TOKEN=your_tts_token
```

**配置说明**：
1. 必须配置 `VOLCENGINE_API_KEY` 和 `VOLCENGINE_ENDPOINT_ID`
2. 多模型端点为可选，未配置时使用默认端点
3. TTS 配置为可选，不配置则语音功能不可用
4. Vercel 部署时需在项目设置中添加这些环境变量

---

### 9.5 接口测试工具

**推荐工具**：
- Postman
- Insomnia
- cURL
- Thunder Client（VS Code 插件）

**cURL 测试示例**：

```bash
# 测试 AI 对话接口
curl -X POST https://e-commerce-ai-tool.vercel.app/api/chat \
  -H "Content-Type: application/json" \
  -d '{
    "messages": [
      {"role": "user", "content": "生成商品标题"}
    ],
    "model": "Doubao-1.5-pro-4k"
  }'

# 测试 TTS 接口
curl -X POST https://e-commerce-ai-tool.vercel.app/api/tts \
  -H "Content-Type: application/json" \
  -d '{"text": "测试语音合成", "voice": "BV001_streaming"}' \
  --output test.mp3
```

---

## 10. 项目总结

### 8.1 项目成果

✅ **功能完整**：AI 文案生成 + 图片智能装饰 + 音视频合成 + 语音配音  
✅ **技术先进**：Next.js 14 + TypeScript + 多模态 AI + TTS  
✅ **部署规范**：GitHub + Vercel + CI/CD 自动化  
✅ **用户体验**：响应式设计 + 拖拽上传 + 实时预览 + 智能反馈  

### 8.2 技术栈总览

| 技术类别 | 使用技术 | 版本 |
|---------|---------|------|
| 前端框架 | Next.js | 14.x |
| 开发语言 | TypeScript | 5.x |
| UI 框架 | Tailwind CSS | 3.x |
| AI 服务 | 火山引擎豆包（6 模型）+ TTS | - |
| 视频处理 | Canvas + MediaRecorder | 原生 API |
| 音频处理 | Web Audio API | 原生 API |
| 语音合成 | 火山引擎 TTS | V1 HTTP API |
| 部署平台 | Vercel | - |
| 版本控制 | Git + GitHub | - |

### 8.3 未来展望

#### 短期优化
- [ ] 支持更多视频格式导出（MP4、GIF）
- [ ] 添加图片编辑功能（裁剪、滤镜）
- [ ] 优化移动端交互体验
- [ ] 增加视频模板库
- [ ] 更多配音音色选择
- [ ] 背景音乐混音功能
- [ ] AI 智能抠图

#### 中期规划
- [ ] 接入更多 AI 模型（文心一言、通义千问）
- [ ] 支持批量处理
- [ ] 添加用户系统和历史记录
- [ ] 提供 API 接口供第三方调用

#### 长期愿景
- [ ] 构建电商素材生成平台
- [ ] 支持多语言文案生成
- [ ] 接入电商平台 API 自动发布
- [ ] 提供企业级 SaaS 服务

---

## 9. 联系方式

**项目地址**：https://e-commerce-ai-tool.vercel.app  
**GitHub 仓库**：https://github.com/niuyiduo/e-commerce-ai-tool  
**开发者**：牛一朵

---

**感谢使用本项目！**  
**如有问题或建议，欢迎通过 GitHub Issues 反馈。**
